import{G as v,H as I,m as w,x as E,q as b,I as d,J as h,K as y,L as T,M as c}from"./BjbBlfYJ.js";function x(e,o,n=o){var r=new WeakSet;v(e,"input",async a=>{var t=a?e.defaultValue:e.value;if(t=m(e)?g(t):t,n(t),d!==null&&r.add(d),await I(),t!==(t=o())){var s=e.selectionStart,i=e.selectionEnd,p=e.value.length;if(e.value=t??"",i!==null){var f=e.value.length;s===i&&i===p&&f>p?(e.selectionStart=f,e.selectionEnd=f):(e.selectionStart=s,e.selectionEnd=Math.min(i,f))}}}),(b&&e.defaultValue!==e.value||w(o)==null&&e.value)&&(n(m(e)?g(e.value):e.value),d!==null&&r.add(d)),E(()=>{var a=o();if(e===document.activeElement){var t=h??d;if(r.has(t))return}m(e)&&a===g(e.value)||e.type==="date"&&!a&&!e.value||a!==e.value&&(e.value=a??"")})}function B(e,o,n=o){v(e,"change",r=>{var a=r?e.defaultChecked:e.checked;n(a)}),(b&&e.defaultChecked!==e.checked||w(o)==null)&&n(e.checked),E(()=>{var r=o();e.checked=!!r})}function m(e){var o=e.type;return o==="number"||o==="range"}function g(e){return e===""?null:+e}const l={TEMPLATES:"clipboard-converter:templates",SETTINGS:"clipboard-converter:settings",RECENT_TEMPLATES:"clipboard-converter:recent",VERSION:"clipboard-converter:version"},S=[{id:"remove-blank-lines",name:"Remove Blank Lines",description:"Remove all blank lines from text",transformations:[{id:"1",type:"remove_blank_lines",enabled:!0,order:1}],starred:!1,category:"Basic",tags:["cleanup"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),usageCount:0},{id:"wrap-code",name:"Wrap in Code Block",description:"Wrap text in markdown code block",transformations:[{id:"1",type:"wrap_code_block",value:"",enabled:!0,order:1}],starred:!0,category:"Markdown",tags:["code","markdown"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),usageCount:0},{id:"format-grafana-errors",name:"Format Grafana Errors",description:"Clean up Grafana error logs and wrap in code block",transformations:[{id:"1",type:"remove_blank_lines",enabled:!0,order:1},{id:"2",type:"trim_lines",enabled:!0,order:2},{id:"3",type:"wrap_code_block",value:"log",enabled:!0,order:3}],starred:!0,category:"Logging",tags:["grafana","errors","logs"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),usageCount:0},{id:"trim-lines",name:"Trim All Lines",description:"Remove leading/trailing whitespace from each line",transformations:[{id:"1",type:"trim_lines",enabled:!0,order:1}],starred:!1,category:"Basic",tags:["cleanup"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),usageCount:0},{id:"bullet-list",name:"Convert to Bullet List",description:'Add "- " prefix to each line',transformations:[{id:"1",type:"add_prefix",value:"- ",enabled:!0,order:1}],starred:!1,category:"Markdown",tags:["markdown","list"],createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),usageCount:0}];function u(){return typeof window<"u"&&typeof window.localStorage<"u"}function C(){if(!u())return S;try{const e=localStorage.getItem(l.TEMPLATES);if(e)return JSON.parse(e)}catch(e){console.error("Error loading templates from localStorage:",e)}return _(),S}function O(e){if(u())try{localStorage.setItem(l.TEMPLATES,JSON.stringify(e))}catch(o){throw console.error("Error saving templates to localStorage:",o),new Error("Failed to save templates. Storage quota may be exceeded.")}}function _(){if(u())try{localStorage.setItem(l.TEMPLATES,JSON.stringify(S)),localStorage.setItem(l.VERSION,"1.0.0")}catch(e){console.error("Error seeding default templates:",e)}}function k(){if(!u())return[];try{const e=localStorage.getItem(l.RECENT_TEMPLATES);if(e)return JSON.parse(e)}catch(e){console.error("Error loading recent templates:",e)}return[]}function D(e){if(u())try{localStorage.setItem(l.RECENT_TEMPLATES,JSON.stringify(e))}catch(o){console.error("Error saving recent templates:",o)}}function P(e){return JSON.stringify(e,null,2)}function J(e){try{const o=JSON.parse(e);if(!Array.isArray(o))throw new Error("Invalid format: expected an array of templates");for(const n of o)if(!n.id||!n.name||!n.transformations)throw new Error("Invalid template format");return o}catch(o){throw new Error("Failed to import templates: "+o.message)}}function L(){const{subscribe:e,set:o,update:n}=T(C());return e(r=>{O(r)}),{subscribe:e,create:r=>{const a={...r,id:`template-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),usageCount:0};return n(t=>[...t,a]),a.id},update:(r,a)=>{n(t=>t.map(s=>s.id===r?{...s,...a,updatedAt:new Date().toISOString()}:s))},delete:r=>{n(a=>a.filter(t=>t.id!==r))},toggleStar:r=>{n(a=>a.map(t=>t.id===r?{...t,starred:!t.starred,updatedAt:new Date().toISOString()}:t))},incrementUsageCount:r=>{n(a=>a.map(t=>t.id===r?{...t,usageCount:t.usageCount+1}:t))},getById:r=>c({subscribe:e}).find(a=>a.id===r),search:r=>{const a=c({subscribe:e});if(!r.trim())return a;const t=r.toLowerCase();return a.filter(s=>s.name.toLowerCase().includes(t)||s.description.toLowerCase().includes(t)||s.tags?.some(i=>i.toLowerCase().includes(t)))},filterByCategory:r=>{const a=c({subscribe:e});return r?a.filter(t=>t.category===r):a},getCategories:()=>{const r=c({subscribe:e}),a=new Set;return r.forEach(t=>{t.category&&a.add(t.category)}),Array.from(a).sort()},duplicate:r=>{const a=c({subscribe:e}).find(s=>s.id===r);if(!a)return;const t={...a,id:`template-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,name:`${a.name} (Copy)`,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),usageCount:0,starred:!1};return n(s=>[...s,t]),t.id},reset:()=>{const{DEFAULT_TEMPLATES:r}=require("$lib/services/localStorage");o(r)}}}const A=L(),F=y(A,e=>e.filter(o=>o.starred).sort((o,n)=>n.usageCount-o.usageCount));function M(){const e=T(k());return e.subscribe(o=>{D(o)}),{subscribe:e.subscribe,add:o=>{e.update(n=>{const r=n.filter(t=>t.templateId!==o);return[{templateId:o,usedAt:new Date().toISOString()},...r].slice(0,10)})},clear:()=>{e.set([])}}}const N=M(),G=y([A,N],([e,o])=>o.map(n=>e.find(r=>r.id===n.templateId)).filter(n=>n!==void 0));export{B as a,x as b,G as c,P as e,J as i,N as r,F as s,A as t};
